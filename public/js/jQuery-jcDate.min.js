"use strict";!function(t,e){"function"==typeof define?define(["jQuery"],function(t){e(t)}):e(t)}(jQuery,function(t){t.fn.jcDate=function(e){var i={Class:"",Default:"today",Event:"click",Speed:100,Left:0,Top:22,Format:"-",DoubleNum:!0,Timeout:100,OnChange:function(){}};return e=t.extend(i,e),t(this).each(function(i,a){function n(t){var e="";for(j in t)e+=t[j];return e}function d(i,a,n,d,l){var o=e.speed;a.fadeOut(o),n.fadeOut(o),i.delay(2*o).fadeIn(o),d?(t("#d_prev,#d_next").fadeOut(o),_.eq(l).hide()):(t("#d_prev,#d_next").fadeIn(o),_.show(),w.show(),k.show())}function l(t){w.text(t);for(var e=0;e<S.length;e++){var i,a,n,d,l="",o="",s="",f="",u=0,c=new Date(t,e,1).getDay();i=void 0==Z(t,e-2)?31:Z(t,e-2);for(var r=1;r<=Z(t,e-1);r++)l=l+"<li class='jcDateColor'>"+r+"</li>";for(var v=0;c>v;v++)f+="<li>"+i+"</li>,",i--;for(var p=0;42-(r+c)>=p;p++)u=p+1,s+="<li>"+u+"</li>";a=f.split(",").reverse();for(d in a)o+=a[d];n=o+l+s,S.eq(e).html(n)}}function o(t){S.eq(t).addClass("dateV").siblings().removeClass("dateV"),k.text(t+1),T.animate({left:161*-t},e.Speed)}function s(e,i,a){w.text(e),k.text(i),l(e),t.each(S.eq(i-1).find("li"),function(){t(this).hasClass("jcDateColor")&&S.eq(i-1).find("li.jcDateColor").eq(a-1).addClass("visited")}),H.val(G),S.eq(i-1).find("li").text(),o(i-1)}function f(){t.each(t("li.jcDateColor",S),function(){t(this).hasClass("visited")&&t(this).removeClass("visited")})}function u(t){var i=t.split(e.Format);return e.DoubleNum&&(i[1]=1===i[1].length?"0"+i[1]:i[1],i[2]=1===i[2].length?"0"+i[2]:i[2]),i.join(e.Format)}function c(){var i,a,n,d,l=w.text(),o=k.text(),s=H.val();if(a=[l,o,s],i=a.join(e.Format),"00"!=E.val()||"00"!=L.val()){var f=E.val();o=L.val(),a.push(f+":"+o),n=a.join(e.Format).substring(),d=n.split("/"),i=d[0]+e.Format+d[1]+e.Format+d[2]+" "+d[3]}t("input.dateVisited").val(u(i)),r(),e.OnChange()}function r(){t("input.dateVisited").removeClass("dateVisited"),y.hide(e.Speed)}0==t("#jcDate").length&&t("body").prepend("<div id='jcDate'><input type='hidden' value='' id='dateHideText' /><div id='jcDateTt'><a id='d_prev'>&#9668;</a><div><span></span><b>年</b><samp></samp><b>月</b></div><a id='d_next'>&#9658;</a></div><dl id='jcYeas'></dl><dl id='jcMonth'></dl><div id='jcDayWrap'><dl id='jcDayCon'></dl><div id='jcDateMax'><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul><ul></ul></div><div id='jcDateBtn'><samp>今天</samp><span>清空</span><a id='d_sub'>确定</a><div id='jcTimeWrap'><input type='text' value='' /><label>:</label><input type='text' value='' /></div></div></div></div>");var v,p,h,j,m,D,x,C=t(a),g=(t(window),new Date),y=t("#jcDate"),b=t("#jcDateTt"),w=(t(this).offset().left,t(this).offset().top,b.find("span")),k=b.find("samp"),_=b.find("b"),T=t("#jcDateMax"),q=t("#jcDayCon"),F=t("#jcDateBtn"),V=t("#jcYeas"),I=t("#jcMonth"),M=F.find("samp"),O=F.find("span"),Y=t("#jcDayWrap"),S=Y.find("ul"),W=F.find("a#d_sub"),H=t("input#dateHideText"),B=t("#jcTimeWrap"),E=B.find("input:eq(0)"),L=B.find("input:eq(1)"),N=t("#d_prev"),Q=t("#d_next"),z=parseInt(g.getFullYear()),A=g.getMonth()+1,G=g.getDate(),J=g.getDay(),K=["日","一 ","二 ","三 ","四 ","五 ","六 "],P=(K[J],g.getHours(),g.getMinutes(),""),R="<dd class='visited'>"+z+"年</dd>",U="",X=0,Z=function(t,e){return[31,t%4==0&&t%100!=0||t%400==0?29:28,31,30,31,30,31,31,30,31,30,31][e+1]},$=z,tt=[],et=[];E.val("00"),L.val("00"),"today"===e.Default?C.val(u([z,A,G].join(e.Format))):C.val(u(e.Default));for(h in K)P=P+"<dt>"+K[h]+"</dt>";q.html(P);for(var it=0;9>it;it++)v=$-(it+1),tt.push("<dt>"+v+"年</dt>");tt.reverse(),D=n(tt),tt.length=0;for(var at=0;8>at;at++)p=$+(at+1),tt.push("<dt>"+p+"年</dt>");x=n(tt),V.html(D+R+x);for(var nt=1;12>=nt;nt++)nt==A?et.push("<dt class='visited'>"+nt+"月</dt>"):et.push("<dt>"+nt+"月</dt>");for(m in et)U+=et[m];I.html(U),w.off().on("click",function(){t(this).addClass("visited").next("samp").removeClass("visited"),d(V,Y,I,!0,1),w.show(),k.hide()}),t("#jcYeas dd,#jcYeas dt").off().on("click",function(){var e=parseInt(t(this).text());l(e),w.text(e),d(Y,V,I,!1)}),k.off().on("click",function(){t(this).addClass("visited").prev().removeClass("visited"),d(I,Y,V,!0,0),k.show(),w.hide()}),I.find("dt").off().on("click",function(){var e=parseInt(t(this).text());o(e-1),k.text(e),d(Y,V,I,!1)}),o(A-1),N.off().on("click",function(){if(X=S.filter(".dateV").index(),X>0)X--;else{var t=parseInt(w.text());t--,l(t),X=S.length-1}o(X)}),Q.off().on("click",function(){if(X=S.filter(".dateV").index(),X<S.length-1)X++;else{var t=parseInt(w.text());t++,l(t),X=0}o(X)}),s(z,A,G),S.undelegate("li.jcDateColor","click").delegate("li.jcDateColor","click",function(){f(),t(this).addClass("visited"),H.val(parseInt(t(this).text()))}),S.undelegate("li.jcDateColor","dblclick").delegate("li.jcDateColor","click",function(){c()}),M.off().on("click",function(){s(z,A,G)}),O.off().on("click",function(){t("input.dateVisited").val("")}),W.off().on("click",function(){c()}),C.addClass(e.Class).off().on(e.Event,function(i){t(this).addClass("dateVisited");var a=t(this).offset();y.css({left:a.left+e.Left,top:a.top+e.Top}),y.show(e.Speed),Y.show(),V.hide(),I.hide(),t("#d_prev,#d_next").show(),w.show(),k.show(),_.show()}),y.off().on("mouseleave",function(){setTimeout(r,e.Timeout)})})}});